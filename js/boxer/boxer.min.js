!function(e){var t=function(t){function n(t){var n,i=e(t),o=document.createElement("div");o.className="boxer-closeBtn",d.append(o),n=e(".boxer-closeBtn"),n.css("top",parseInt(i.css("top"))-20+"px"),n.css("left",parseInt(i.css("left"))+parseInt(i.css("width"))+12+"px"),d.on("click",function(){i.remove(),e(this).remove(),e(this).off()})}function i(i){var r,a,s,c,h=i.target;return i.preventDefault(),h="A"!==h.nodeName?i.target.parentNode:h,"A"!==h.nodeName?!1:(r=e(h).attr("data-type")||"",console.log(r),e("body").append(e("<div></div>").addClass(t.overlayName)),d=e("."+t.overlayName),outSideContainer=document.createElement("div"),outSideContainer.id="imgContainer",a=o(h,r,function(){outSideContainer.appendChild(a),console.dir(e(outSideContainer)[0].firstChild),e(outSideContainer)[0].firstChild.width?(s=e(outSideContainer)[0].firstChild.width,c=e(outSideContainer)[0].firstChild.height):(s=t.width,c=t.height,e(e(outSideContainer)[0].firstChild).css("width",s),e(e(outSideContainer)[0].firstChild).css("height",c)),console.log(s,c),(s>.7*e(window).width()||c>.7*e(window).height())&&(s=parseInt(s/2),c=parseInt(c/2),e(outSideContainer)[0].firstChild.width=s),e(outSideContainer)[0].firstChild.width=s,e(outSideContainer).css({top:e(window).height()/2-parseInt(c/2)+"px",left:e(window).width()/2-parseInt(s/2)+"px"}),n(outSideContainer)}),d.append(outSideContainer),t.beforeShow&&t.beforeShow(),!1)}function o(t,n,i){var o,d,r,a;return o=document.createDocumentFragment(),console.log(t,n),""===n||"image"===n?(d=document.createElement("img"),d.src=t.href,o.appendChild(d),t.title&&(a=document.createElement("p"),r=document.createTextNode(t.title),a.appendChild(r),o.appendChild(a)),d.addEventListener("load",i)):"ajax"===n&&(d=document.createElement("div"),console.log("ajax"),e(d).load(t.href,function(e){o.appendChild(d),i(e)})),o}var d,r=t.obj;r.off().on("click",i)};e.fn.boxer=function(n){var i=e.extend({overlayName:"previewOverlay",width:600,height:400},n);return this.filter("div").each(function(){e.each(this.children,function(){console.log(this),t(e.extend({obj:e(this)},i))})}),this}}(jQuery);